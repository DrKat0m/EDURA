{{!
    This file is part of Moodle - https://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template mod_geniai/chat

    Example context (json):
    {
        "geniainame": "Name",
        "manage_capability": true,
        "message_01": "string",
        "message_02": "string"
    }
}}

<div id="page-mod-geniai-view">
  <div class="theme-toggle-container">
    <button id="theme-toggle-btn">
      <span class="theme-icon">üåô</span>
      <span class="theme-text">Dark Mode</span>
    </button>
  </div>
  <div id="geniai-mod-popup">

    <input type="hidden" id="local_geniai_message_01" value="{{message_01}}">
    <input type="hidden" id="local_geniai_message_02" value="{{message_02}}">
    <a id="geniai-clear-history"
       title="{{#str}}clear_history_title,local_geniai{{/str}}"
       href="#"
       role="button"
       aria-label="{{#str}}clear_history_title,local_geniai{{/str}}">
        {{#pix}}icons/clear,local_geniai{{/pix}}
        <span class="clear-text">Clear Chat</span>
    </a>
    <div id="geniai-scrollarea">
        <div id="geniai-area-mensagens"></div>
    </div>
    <div id="geniai-sendarea">
            <textarea id="geniai-textarea" contenteditable="true"
                      placeholder="{{#str}}write_message,local_geniai{{/str}}"></textarea>

        <div id="geniai-icon-stop"
             style="display: none">
            {{#pix}}icons/stop,local_geniai{{/pix}}
        </div>

        <div id="geniai-icon-mic"
             title="{{#str}}send_message,local_geniai{{/str}}">
            {{#pix}}icons/mic,local_geniai{{/pix}}
        </div>
        <div id="geniai-icon-send" title="{{#str}}send_message,local_geniai{{/str}}">
            {{#pix}}icons/send,local_geniai{{/pix}}
        </div>
    </div>
</div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const toggleBtn = document.getElementById("theme-toggle-btn");
    const container = document.getElementById("page-mod-geniai-view");

    if (!toggleBtn) return;

    // Load saved theme preference on page load
    const savedTheme = localStorage.getItem("geniai-theme");
    if (savedTheme === "dark") {
        container.classList.add("dark-mode");
        toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
    }

    toggleBtn.addEventListener("click", function () {
        const isDark = container.classList.toggle("dark-mode");
        toggleBtn.textContent = isDark ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
        localStorage.setItem("geniai-theme", isDark ? "dark" : "light");
    });
});
</script>

